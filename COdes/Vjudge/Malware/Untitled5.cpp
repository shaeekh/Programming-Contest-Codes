#include<bits/stdc++.h>
using namespace std;
int main()
{
    int t;
    cin>>t;
    for (int i=1;i<=t;i++)
    {
        printf("Case %d:\n",i);
        list<int> lis;
        int n,m;
        cin>>n>>m;
        int count=0;

        for (int j=1;j<=m;j++)
        {



            string s;
            getline(cin,s);
            if(s.size()>7)
            {


            int em=(s.size())-1;
            char fin=s[em];
            int d=
                        //cout<<s[1];
            if(s[1]=='u')
            {
                if(s[4]=='L')
                {
                    count++;
                    if(count<=n)
                    {lis.push_front(d);
                    printf("Pushed in left: %d\n",d);
                    //count++;
                    }

                }
                else if (s[4]=='R' )
                {
                    count++;
                    if(count<=n)
                    {
                        lis.push_back(d);
                        printf("Pushed in right: %d\n",d);
                        //count++;
                    //print korte hobe
                }
            }
            else if(s[1]=='o')
            {
                if(s[3]=='L')
                {
                    lis.pop_front();
                    printf("Popped from left: %d\n",lis.front());
                }
                else if(s[3]=='R')
                    {
                        lis.pop_back();
                        //print
                        printf("Popped from right: %d\n",lis.back());
                  }

        }
        if(count>=n+1)
            {
                //count=0;

                printf("The queue is full\n");
            }
         if(lis.empty())
                printf("The queue is empty\n");
    }
}
}
}

